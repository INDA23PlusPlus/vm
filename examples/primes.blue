let
	is_prime n p =
		let loop k n p =
			if k = len p
			then 1
			else
				if n % p $ k = 0
				then 0
				else loop k + 1 n . p;
		in loop 0 n . p;
	list_primes n =
		print 2 . ->
		let
			p = [2];
			loop k n p =
				if k = n
				then ()
				else
					if is_prime k . p
					then print k . -> loop k + 1 n . p :: k
					else loop k + 1 n . p;
		in loop 3 n . p;
in list_primes 100 . -> 0
